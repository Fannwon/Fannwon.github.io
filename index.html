<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>å…¨åŠŸèƒ½éŸ³ä¹æ’­æ”¾å™¨ | GitHub Pages</title>
    <!-- APlayer æ ·å¼ -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.css">
    <style>
        /* åŸºç¡€æ ·å¼ */
        body {
            margin: 0;
            padding: 20px;
            background: #f8f9fa;
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
        }

        /* æ¡Œé¢ç«¯æ’­æ”¾å™¨æ ·å¼ */
        .aplayer {
            max-width: 800px;
            margin: 20px auto;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            body { padding: 10px; }
            
            .aplayer {
                border-radius: 0 !important;
                margin: 0;
                max-width: 100%;
            }
            
            /* å›ºå®šæ¨¡å¼ä¼˜åŒ– */
            .aplayer.aplayer-fixed {
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                width: 100% !important;
            }
        }

        /* è§£é”æŒ‰é’®æ ·å¼ */
        #unlock-btn {
            position: fixed;
            bottom: 30px;
            right: 30px;
            padding: 12px 24px;
            background: #FF6B6B;
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            z-index: 999;
            box-shadow: 0 4px 12px rgba(255,107,107,0.3);
            transition: all 0.3s ease;
        }
        #unlock-btn:hover { transform: scale(1.05); }
    </style>
</head>
<body>
    <!-- è‡ªåŠ¨æ’­æ”¾å¼•å¯¼æŒ‰é’® -->
    <button id="unlock-btn" onclick="unlockAudio()">ğŸµ ç‚¹å‡»å¼€å§‹éŸ³ä¹ä¹‹æ—…</button>
    
    <!-- æ’­æ”¾å™¨å®¹å™¨ -->
    <div id="player"></div>

    <!-- ä¾èµ–åº“ -->
    <script src="https://cdn.jsdelivr.net/npm/aplayer@1.10.1/dist/APlayer.min.js"></script>
    
    <!-- é…ç½®è„šæœ¬ -->
    <script>
        // ========== æ’­æ”¾åˆ—è¡¨é…ç½® ========== //
        const playlist = [
            {
                name: 'ç¤ºæƒ…',
                artist: 'èŒƒæ–‡èŠ³',
                url: 'music/èŒƒæ–‡èŠ³ - ç¤ºæƒ….mp3',
                cover: 'covers/nature.jpg',
                lrc: 'lyrics/summer.lrc'  // å¯é€‰æ­Œè¯
            },
            {
                name: 'åŸå¸‚å¤œæ™š',
                artist: 'ç”µå­è„‰æ',
                url: 'music/city_night.mp3',
                cover: 'covers/city.jpg',
                theme: '#2196F3'  // å•æ›²è‡ªå®šä¹‰ä¸»é¢˜è‰²
            },
            {
                name: 'é’¢ç´ç‹¬å¥',
                artist: 'å¤å…¸ç²¾é€‰',
                url: 'music/piano_solo.mp3',
                cover: 'covers/piano.jpg'
            }
        ].sort(() => Math.random() - 0.5);  // åˆå§‹éšæœºæ’åº

        // ========== æ’­æ”¾å™¨åˆå§‹åŒ– ========== //
        const ap = new APlayer({
            container: document.getElementById('player'),
            audio: playlist,
            fixed: true,        // å›ºå®šæ¨¡å¼
            mini: window.innerWidth < 768,  // è‡ªåŠ¨åˆ‡æ¢è¿·ä½ æ¨¡å¼
            autoplay: true,    // è‡ªåŠ¨æ’­æ”¾ï¼ˆéœ€ç”¨æˆ·äº¤äº’åç”Ÿæ•ˆï¼‰
            loop: 'all',       // å¾ªç¯æ¨¡å¼ï¼šall | one | none
            order: 'random',   // æ’­æ”¾é¡ºåºï¼šrandom | list
            volume: 0.8,       // åˆå§‹éŸ³é‡
            theme: '#FF6B6B',  // ä¸»è‰²è°ƒ
            lrcType: 3         // æ­Œè¯è§£ææ¨¡å¼
        });

        // ========== è‡ªåŠ¨æ’­æ”¾è§£é” ========== //
        function unlockAudio() {
            ap.play();
            document.getElementById('unlock-btn').style.display = 'none';
            // è¯·æ±‚é€šçŸ¥æƒé™ï¼ˆå¯é€‰ï¼‰
            if (Notification.permission !== 'denied') {
                Notification.requestPermission();
            }
        }

        // ========== å“åº”å¼ç›‘å¬ ========== //
        window.addEventListener('resize', () => {
            ap.mini = window.innerWidth < 768;
        });

        // ========== æ’­æ”¾çŠ¶æ€è®°å¿† ========== //
        window.addEventListener('beforeunload', () => {
            localStorage.setItem('last-played', JSON.stringify({
                index: ap.list.index,
                time: ap.audio.currentTime
            }));
        });

        // è¯»å–æ’­æ”¾çŠ¶æ€
        const lastPlay = JSON.parse(localStorage.getItem('last-played'));
        if (lastPlay) {
            ap.list.switch(lastPlay.index);
            ap.audio.currentTime = lastPlay.time;
        }

        // ========== æ¡Œé¢é€šçŸ¥ ========== //
        ap.on('play', () => {
            if (Notification.permission === 'granted') {
                new Notification('æ­£åœ¨æ’­æ”¾', {
                    body: `${ap.audio.name} - ${ap.audio.author}`,
                    icon: ap.audio.cover
                });
            }
        });
    </script>
</body>
</html>